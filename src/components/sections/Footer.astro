---
const today = new Date();
const currentYear = new Date().getFullYear();
import whatsappIconRaw from "../../assets/icons/whatsapp-icon.svg?raw";
import Button from "../ui/button/Button.astro";
import { footerLinks } from "@/data/footer_link";
import GlowLineSeparator from "../ui/separator/GlowLineSeparator.astro";

function sanitizeToWhite(svg: string, size = 18) {
  let s = svg
    .replace(/<\?xml[\s\S]*?\?>/g, "")
    .replace(/<!--([\s\S]*?)-->/g, "")
    .replace(/width=\"[^\"]*\"/g, "")
    .replace(/height=\"[^\"]*\"/g, "")
    // Ensure shapes are visible: use white via currentColor on fill, drop strokes
    .replace(/fill=\"[^\"]*\"/gi, 'fill="currentColor"')
    .replace(/stroke=\"[^\"]*\"/gi, 'stroke="none"');
  s = s.replace(
    /<svg([^>]*)>/,
    (m, attrs) => `<svg${attrs} width="${size}" height="${size}">`
  );
  return s;
}

const whatsappIcon = sanitizeToWhite(whatsappIconRaw);
const feedUrl = new URL("rss.xml", Astro.site).toString();
const feedlyUrl = `https://feedly.com/i/subscription/feed/${feedUrl}`;
const inoreaderUrl = `https://www.inoreader.com/?add_feed=${feedUrl}`;
---

<section id="contact" class="text-center">
  <h2 class="text-2xl md:text-3xl font-semibold text-foreground">
    Masih Bingung Mulai dari Mana?
  </h2>
  <p class="mt-2 text-[color:var(--color-text-muted)]">
    Diskusikan kebutuhan software Anda secara gratis. Kami akan bantu memetakan
    solusi teknis yang paling tepat dan hemat biaya.
  </p>
  <div class="my-6 flex justify-center">
    <Button href="https://wa.me/6285269381286" variant="secondary" size="md">
      <span
        class="inline-flex mx-2"
        aria-hidden="true"
        set:html={whatsappIcon}
      />
      Konsultasi Gratis (via WA)
    </Button>
  </div>
  <!-- <div class="mt-6 text-sm text-[color:var(--color-text-muted)]">Made by: <a href="https://guihubie.com" class="hover:text-[color:var(--accent)]">guihubie</a>.</div>
  <div class="mt-6 flex items-center justify-center gap-4 text-sm">
    <a class="sw-btn-sm" href={feedlyUrl} target="_blank" rel="noopener noreferrer" aria-label="Subscribe in Feedly">Feedly</a>
    <a class="sw-btn-sm" href={inoreaderUrl} target="_blank" rel="noopener noreferrer" aria-label="Subscribe in Inoreader">Inoreader</a>
    <button class="sw-btn-sm" type="button" data-copy={feedUrl} aria-label="Copy RSS link">Copy RSS link</button>
    <a class="sw-btn-sm" href="/blog/" aria-label="Browse all posts">All posts</a>
  </div> -->
  <GlowLineSeparator />
  <footer class="bg-gray-900 text-white pt-16 mt-10 pb-4">
    <div class="container mx-auto w-full px-4m sm:px-6 lg:px-8">
      <div
        class="grid px-4 md:grid-cols-2 lg:grid-cols-5 gap-8 mb-12 max-w-7xl"
      >
        <div
          class="flex flex-col items-center md:justify-items-start md:items-start md:col-span-2 lg:col-span-2"
        >
          <a
            href="/"
            class="flex items-center mb-6"
            aria-label="Go to homepage"
          >
            <svg
              class="h-8 w-auto text-primary-400"
              viewBox="0 0 40 40"
              fill="currentColor"
            >
              <path
                d="M20 5C11.716 5 5 11.716 5 20C5 28.284 11.716 35 20 35C28.284 35 35 28.284 35 20C35 11.716 28.284 5 20 5ZM20 10C22.761 10 25 12.239 25 15C25 17.761 22.761 20 20 20C17.239 20 15 17.761 15 15C15 12.239 17.239 10 20 10ZM20 32C16.218 32 12.848 30.154 10.859 27.307C12.839 24.663 16.159 23 20 23C23.841 23 27.161 24.663 29.141 27.307C27.152 30.154 23.782 32 20 32Z"
              ></path>
            </svg>
            <span class="ml-2 text-xl font-display font-semibold text-white"
              >BikinSoftware</span
            >
          </a>
          <p class="text-lg leading-6 text-slate-400 max-w-md md:text-left">
            Partner teknologi andalan untuk transformasi digital bisnis Anda.
            Kami menyediakan layanan pembuatan Fullstack Web, Landing Page
            performa tinggi, hingga Otomatisasi Sistem berbasis AI. Fokus kami
            adalah memberikan solusi teknis yang efisien, aman, dan berdampak
            nyata pada pertumbuhan profit Anda.
          </p>
          <div class="flex space-x-4">
            <a
              href="#"
              class="text-gray-400 hover:text-primary-400 transition-colors"
              aria-label="LinkedIn"
            >
              <svg
                class="w-6 h-6"
                fill="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"
                ></path>
              </svg>
            </a>
            <a
              href="#"
              class="text-gray-400 hover:text-primary-400 transition-colors"
              aria-label="Facebook"
            >
              <svg
                class="w-6 h-6"
                fill="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"
                ></path>
              </svg>
            </a>
            <a
              href="#"
              class="text-gray-400 hover:text-primary-400 transition-colors"
              aria-label="GitHub"
            >
              <svg
                class="w-6 h-6"
                fill="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
                ></path>
              </svg>
            </a>
          </div>
        </div>

        {
          footerLinks.map((column) => (
            <div class="flex flex-col items-center md:justify-items-start">
              <h3 class="text-lg font-semibold mb-4">{column.title}</h3>
              <ul>
                {column.links.map((link) => (
                  <li class="md:text-left">
                    <a
                      href={link.url}
                      class="no-underline text-lg text-gray-400 hover:text-[color:var(--accent)] transition-colors  "
                    >
                      {link.text}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          ))
        }
      </div>

      <div class="border-t border-gray-800 pt-8 mt-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-400 text-sm mb-4 md:mb-0">
            &copy; {currentYear} BikinSoftware. All rights reserved.
          </p>
          <div class="flex space-x-6">
            <a
              href="/privacy-policy"
              class="text-gray-400 hover:text-primary-400 text-sm transition-colors"
              >Privacy Policy</a
            >
            <a
              href="/terms-conditions"
              class="text-gray-400 hover:text-primary-400 text-sm transition-colors"
              >Terms of Service</a
            >
            <a
              href="#"
              class="text-gray-400 hover:text-primary-400 text-sm transition-colors"
              >Cookie Policy</a
            >
          </div>
        </div>
      </div>
    </div>
  </footer>
  <script type="module">
    document.addEventListener("click", (e) => {
      const target = e.target;
      if (!(target instanceof HTMLElement)) return;
      if (target.matches("button[data-copy]")) {
        const url = target.getAttribute("data-copy");
        if (!url) return;
        navigator.clipboard?.writeText(url);
        const original = target.textContent || "Copy RSS link";
        target.textContent = "Copied!";
        setTimeout(() => {
          target.textContent = original;
        }, 1500);
      }
    });
  </script>
</section>
